<?xml version="1.0"?>
<f:view
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:liferay-faces="http://liferay.com/tld/faces"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:collab="http://climatecollaboratorium.org/facelets"
        xmlns:fn="http://java.sun.com/jsp/jstl/functions"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:collabcomps="http://climatecollaboratorium.org/components">
    <ice:form>
<collabcomps:helpMessage messageId="planHelp" styleClass="planHelp" hideThisMessage="Hide this message">
    At the core of the CoLab is an evolving collection of user-created&#160;<a href="http://cognosis.mit.edu:8888/web/guest/resources/-/wiki/Main/Plans+help">Plans</a> comprised of:
    <ul>
       <li>proposed actions,</li>
       <li>simulation&#160;<a href="http://cognosis.mit.edu:8888/web/guest/resources/-/wiki/Main/Models+help">models</a></li>
       <li>projected impacts.</li></ul>
    In&#160;<a href="http://cognosis.mit.edu:8888/web/guest/resources/-/wiki/Main/Contest+help">Contests</a>, teams work together to create plans. This year's
contest, the&#160;<a class="http://www.climatecolab.org/web/guest/resources/-/wiki/Main/CoLab+Global+Challenge">CoLab Global Challenge</a>, starts in
September.
</collabcomps:helpMessage>
<collabcomps:helpMessageTrigger messageId="planHelp">+show help</collabcomps:helpMessageTrigger>
</ice:form>


    <ice:panelSeries var="contest" value="#{plansTypeIndexBean.contests}" styleClass="categorySeriesContainer">
        <ice:panelGroup styleClass="categoryDisplay">
            <ice:panelGroup styleClass="categoryDetails">
                <ice:form>
                    <ice:panelGroup styleClass="categoryHeader" rendered="#{not contest.editor.editing}">
                        <h2><ice:outputText styleClass="categoryName" value="#{contest.name}"/></h2>
                        <ice:commandButton styleClass="editCategoryButton" value="Edit" action="#{contest.editor.edit}" rendered="#{not contest.editor.editing and permissions.canAdminAll}"/>
                    </ice:panelGroup>
                    <ice:panelGroup styleClass="categoryHeader" rendered="#{contest.editor.editing}">
                        <h2><ice:inputText styleClass="categoryName" value="#{contest.editor.name}"/></h2>
                    </ice:panelGroup>
                    <ice:panelGroup styleClass="categoryDescription" rendered="#{not contest.editor.editing}">
                        <ice:outputText value="#{contest.description}"/>
                    </ice:panelGroup>
                    <ice:panelGroup styleClass="categoryDescription" rendered="#{contest.editor.editing}">
                        <ice:inputTextarea value="#{contest.editor.description}"/>
                    </ice:panelGroup>
                    <ice:panelGrid columns="2" styleClass="editCategory buttonPanel" rendered="#{contest.editor.editing}">
                         <ice:commandButton value="Save" action="#{contest.editor.save}"/>
                        <ice:commandButton value="Cancel" action="#{contest.editor.cancel}"/>
                    </ice:panelGrid>
                </ice:form>
            </ice:panelGroup>
            <ice:panelGroup styleClass="categoryContents">
                <ice:dataTable var="phase" value="#{contest.phases}" headerClass="categoryContentsTableHeader"
                               styleClass="categoryContentsTable"
                               columnClasses="phaseName,phaseStatus,phasePlanCount, phaseStart,phaseEnd">>
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="Phase"/>

                        </f:facet>
                        <ice:outputLink value="#plans=phaseId:#{phase.phaseId}">
                            <ice:outputText value="#{phase.name}"/>
                        </ice:outputLink>
                    </ice:column>
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="Status"/>

                        </f:facet>
                        <ice:outputText value="#{phase.status}"/>

                    </ice:column>
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="Count"/>
                        </f:facet>
                        <ice:outputText value="#{fn:length(phase.plans)}"/>

                    </ice:column>
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="Start Date"/>

                        </f:facet>
                        <ice:outputText value="#{phase.startDate}">
                             <f:convertDateTime type="date" dateStyle="short"/>
                         </ice:outputText>

                    </ice:column>
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="End Date"/>


                        </f:facet>
                        <ice:outputText value="#{phase.endDate}">
                            <f:convertDateTime type="date" dateStyle="short"/>
                         </ice:outputText>

                    </ice:column>


                </ice:dataTable>
            </ice:panelGroup>

        </ice:panelGroup>


    </ice:panelSeries>


</f:view>