<?xml version="1.0"?>
<f:view

        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:fn="http://java.sun.com/jsp/jstl/functions"   
        xmlns:collab="http://climatecollaboratorium.org/facelets">

<ice:form>
    <ui:include src="../createPlan.xhtml">
        <ui:param value="#{navigation.createPlanBean}" name="createPlanBean"/>
    </ui:include>
</ice:form>

<div id="content">
<div class="headline contest-page">
    <div class="contest-image"><img src="#{contest.contest.logo}" width="52" height="52" alt="Contest Image" /></div>
    <h1>${contest.contest.shortName}</h1>
    <f:subview rendered="#{plansIndex.contestPhase.daysTillEnd gt 0}">
        <div class="days-left"><span>#{plansIndex.contestPhase.daysTillEnd}</span> days until #{plansIndex.contestPhase.name} ends</div>
    </f:subview>
    <f:subview rendered="#{plansIndex.contestPhase.daysTillEnd eq 0}">
        <f:subview rendered="#{plansIndex.contestPhase.hoursTillEnd gt 0}">
            <div class="days-left"><span>#{plansIndex.contestPhase.hoursTillEnd}</span> hours until #{plansIndex.contestPhase.name} ends</div>
        </f:subview>
        <f:subview rendered="#{plansIndex.contestPhase.hoursTillEnd eq 0}">
            <div class="days-left"><span>#{plansIndex.contestPhase.minutesTillEnd}</span> minutes until #{plansIndex.contestPhase.name} ends</div>
        </f:subview>
    </f:subview>
    
</div> <!-- /headline -->

 <div class="blueheaderbar">
    <div class="contestbar">
        <ui:include src="./contests/widget_CONTEST_PHASES_#{contest.contestState}.xhtml" />
    </div>
 </div>
 <div class="shadebar"></div>


<div class="contest-detail">
    <div class="heading">#{contest.contest.name}</div>
    <div class="description">
        <p>#{contest.contest.description}</p>
        <f:subview rendered="#{contest.contest.hasFocusArea}">
            <ice:panelGroup styleClass="what" rendered="#{not empty contest.contest.what}"><strong>What:</strong>
                <ui:include src="./contests/widget_WHAT_WHERE_WHO.xhtml">
                    <ui:param name="whatWhoWhere" value="#{contest.contest.what}" />
                </ui:include>
            </ice:panelGroup>
            
            <ice:panelGroup styleClass="where" rendered="#{not empty contest.contest.where}"><strong>Where:</strong> 
                <ui:include src="./contests/widget_WHAT_WHERE_WHO.xhtml">
                    <ui:param name="whatWhoWhere" value="#{contest.contest.where}" />
                </ui:include>
            </ice:panelGroup>
            
            <ice:panelGroup styleClass="who" rendered="#{not empty contest.contest.who}"><strong>Who:</strong> 
                <ui:include src="./contests/widget_WHAT_WHERE_WHO.xhtml">
                    <ui:param name="whatWhoWhere" value="#{contest.contest.who}" />
                </ui:include>
            
            </ice:panelGroup>
        </f:subview>
    </div>
    <div class="moreinfo">
        <f:subview rendered="#{fn:length(contest.contest.contest.teamMembers) gt 0}">
            <ice:panelSeries styleClass="advisors" var="teamMember" value="#{contest.contest.contest.teamMembers}">
            <span>#{teamMember.role}:&amp;nbsp;<collab:userLinkSimple userId="#{teamMember.userId}" text="#{teamMember.user.fullName}" /></span>
            
            </ice:panelSeries>
        </f:subview>
        <div class="buttons">
            <f:subview rendered="#{not empty contest.contest.resourcesUrl}">
                <a href="#{contest.contest.resourcesUrl}">Resources</a>
            </f:subview>
            <a href="/web/guest/plans/-/plans/contestId/#{contest.contestId}/page/discussion">Discussion</a></div>
    </div>
 </div>
 
  
 
 <div class="headline subhead">
    <h2><span>#{contest.contest.plansIndex.plansCount}</span> proposals</h2>
    <div class="right">
        <f:subview rendered="#{plansIndex.contestPhase.status == 'OPEN_FOR_SUBMISSION'}">
            <ice:form>
                <div class="blue-button">
                    <ice:commandLink onclick="if(!deferUntilLogin()) return false; Collab.nav.block();"
                            actionListener="#{navigation.createPlanBean.createPlan}">
                        <span>CREATE</span> proposal
                    </ice:commandLink>
                </div>
            </ice:form>
        </f:subview>
    </div>
</div> <!-- /headline.subhead -->
 
 
<ui:decorate template="./contests/widget_PLANS_LIST.xhtml">
    <ui:param name="maxRows" value="#{contest.contest.plansIndex.pageSize}" />
    <ui:param name="renderPaginator" value="true" />
</ui:decorate>
     </div>
</f:view>
