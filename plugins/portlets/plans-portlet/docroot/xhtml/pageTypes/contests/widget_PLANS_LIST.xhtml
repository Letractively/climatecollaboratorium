<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2010. M.I.T. All Rights Reserved
  ~ Licensed under the MIT license. Please see http://www.opensource.org/licenses/mit-license.php
  ~ or the license.txt file included in this distribution for the full text of the license.
  -->

<f:view  xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:ice="http://www.icesoft.com/icefaces/component" 
    xmlns:liferay-faces="http://liferay.com/tld/faces"
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:collab="http://climatecollaboratorium.org/facelets"
    xmlns:h="http://java.sun.com/jsf/html"  >
    
    <ice:form>
    <div class="blueheaderbar tooltips">
        <div class="proposalname">
            <div style="display: inline-block">
                <ice:commandLink actionListener="#{plansIndex.updateSortColumn}" value="Proposal name">
                    <f:attribute name="sortColumn" value="NAME" />
                </ice:commandLink>
                <ui:include src="./widget_SORT_ARROW.xhtml">
                    <ui:param name="sortColumn" value="#{plansIndex.sortColumn}" />
                    <ui:param name="currentColumn" value="NAME" />
                    <ui:param name="sortAscending" value="#{plansIndex.sortAscending}" />
                </ui:include>
                <div class="tooltip">click to sort by name<div class="tt-arrow"></div></div>
            </div>
             /&amp;nbsp;
            
            <div style="display: inline-block">
                <ice:commandLink actionListener="#{plansIndex.updateSortColumn}" value="Author(s)">
                    <f:attribute name="sortColumn" value="CREATOR" />
                </ice:commandLink>
                <ui:include src="./widget_SORT_ARROW.xhtml">
                    <ui:param name="sortColumn" value="#{plansIndex.sortColumn}" />
                    <ui:param name="currentColumn" value="CREATOR" />
                    <ui:param name="sortAscending" value="#{plansIndex.sortAscending}" />
                </ui:include>
                
                <div class="tooltip">click to sort by author<div class="tt-arrow"></div></div>
            </div>
        </div>
        <div class="thumbs">
            <ice:commandLink actionListener="#{plansIndex.updateSortColumn}" value=" ">
                <f:attribute name="sortColumn" value="SUPPORTERS" />
                <img src="/climatecolab-theme/images/icon-proposal-thumb.png" style="margin-top: 8px;" />
            </ice:commandLink>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{plansIndex.sortColumn}" />
                <ui:param name="currentColumn" value="SUPPORTERS" />
                <ui:param name="sortAscending" value="#{plansIndex.sortAscending}" />
            </ui:include>
            <div class="tooltip">click to sort by<br />number of supporters<div class="tt-arrow"></div></div>
        </div>
        <div class="propcomm">
            <ice:commandLink actionListener="#{plansIndex.updateSortColumn}" value=" ">
                <f:attribute name="sortColumn" value="COMMENTS" />
                <img src="/climatecolab-theme/images/icon-list-comment.png" style="margin-top: 8px;" />
            </ice:commandLink>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{plansIndex.sortColumn}" />
                <ui:param name="currentColumn" value="COMMENTS" />
                <ui:param name="sortAscending" value="#{plansIndex.sortAscending}" />
            </ui:include>
            <div class="tooltip">click to sort by<br />number of comments<div class="tt-arrow"></div></div>
        </div>
        <div class="modified">
            <ice:commandLink actionListener="#{plansIndex.updateSortColumn}" value="Modified">
                <f:attribute name="sortColumn" value="UPDATE_DATE" />
            </ice:commandLink>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{plansIndex.sortColumn}" />
                <ui:param name="currentColumn" value="UPDATE_DATE" />
                <ui:param name="sortAscending" value="#{plansIndex.sortAscending}" />
            </ui:include>
            <div class="tooltip">click to sort by date<div class="tt-arrow"></div></div>
        </div>
        <div class="contributor">
            <ice:commandLink actionListener="#{plansIndex.updateSortColumn}" value="Contributors">
                <f:attribute name="sortColumn" value="IS_PLAN_OPEN" />
            </ice:commandLink>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{plansIndex.sortColumn}" />
                <ui:param name="currentColumn" value="IS_PLAN_OPEN" />
                <ui:param name="sortAscending" value="#{plansIndex.sortAscending}" />
            </ui:include>
            <div class="tooltip">click to sort by contributor<div class="tt-arrow"></div></div>
        </div>
    </div></ice:form>
    <div class="shadebar"></div>
    
    
    <ice:panelSeries var="singleProposal" value="#{plansIndex.plans}">
        <div class="propbox">
            <div class="row1">
                <div class="title-author">
                
                    <h4>
                        <f:subview rendered="#{singleProposal.scrapbook}">
                            <div class="tooltips" style="display: inline-block;">
                                <div>
                                <a href="javascript:;">
                                    <img src="/climatecolab-theme/images/scrapbook_icon.png"  class="scrapbook_icon" width="20px" height="20px" />
                                </a> 
                                </div>
                                <div class="tooltip">#{singleProposal.scrapbookText}<div class="tt-arrow"></div></div>
                            </div>
                        </f:subview>
                        
                        <f:subview rendered="#{singleProposal.ribbon != null and singleProposal.ribbon > 0}">
                            <div class="tooltips" style="display: inline-block;">
                                <div>
                                    <a href="javascript:;" class="ribbon-hover planRibbon ribbon_#{singleProposal.ribbon}">&amp;nbsp;</a>
                                    <div class="tooltip">
                                        #{singleProposal.ribbonText}
                                        <div class="tt-arrow"></div>
                                    </div>
                                </div>
                            </div>
                        </f:subview>
                        
                        <collab:planLink planId="#{singleProposal.planId}" contestId="#{singleProposal.contestId}" text="#{singleProposal.name}" escape="true" />
                        
                        /&amp;nbsp;
                        <f:subview rendered="#{empty singleProposal.team}">
                            <collab:userLinkSimple userId="#{singleProposal.author.userId}" text="#{singleProposal.author.screenName}" />
                        </f:subview>
                        <f:subview rendered="#{not empty singleProposal.team}">
                            #{singleProposal.team}
                        </f:subview>
                    </h4>
                </div>
                <div class="thumbbox">
                    <collab:planLink planId="#{singleProposal.planId}" contestId="#{singleProposal.contestId}" text="#{singleProposal.supportersCount}" hashString="plans%3Dtab%3ATEAM"/>
                </div>
                <div class="commbox">
                    <collab:planLink planId="#{singleProposal.planId}" contestId="#{singleProposal.contestId}" text="#{singleProposal.commentsCount}" hashString="plans%3Dtab%3ACOMMENTS" />
                </div>
                <div class="modbox">
                    <ice:outputText value="#{singleProposal.lastModifiedDate}" >
                        <f:convertDateTime pattern="d/MM/yy" />
                    </ice:outputText>
                </div>
                <div class="conbox">
                    <f:subview rendered="#{singleProposal.open}">
                        anyone
                    </f:subview>
                    <f:subview rendered="#{not singleProposal.open}">
                        team only
                    </f:subview>
                </div>
            </div>
            <div class="row2">
                #{singleProposal.abstract}
            </div>
        </div> <!-- /proposal -->
    </ice:panelSeries>
    
    <script type="text/javascript">
        initTooltips();
    </script>
    
    
</f:view>