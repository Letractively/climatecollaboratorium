<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2010. M.I.T. All Rights Reserved
  ~ Licensed under the MIT license. Please see http://www.opensource.org/licenses/mit-license.php
  ~ or the license.txt file included in this distribution for the full text of the license.
  -->

<f:view
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:collab="http://climatecollaboratorium.org/facelets"
        xmlns:sharedcollab="http://climatecollaboratorium.org/components">

<ice:panelGroup styleClass="hidden" >
  #{contests}
  <script type="text/javascript">
    initializeColumnsInfo();
  </script>
</ice:panelGroup>
<div id="content">
    <div class="headline formmargin">
    <h1>Contests</h1>
    <ice:form>
    <div class="view ${contests.viewType.lowerCase}view"> <!-- To switch the button over to list view just change "gridview" to "listview" -->
        <div class="grid">
            <div>
                <f:subview rendered="#{contests.viewType != 'GRID'}">
                    <ice:commandLink actionListener="#{contests.setViewType}" value="Grid View">
                        <f:attribute name="viewType" value="GRID" />
                    </ice:commandLink>
                </f:subview>
                <f:subview rendered="#{contests.viewType == 'GRID'}">
                    Grid View
                </f:subview>
            
            </div></div>
        <div class="list">
            <div>
                <f:subview rendered="#{contests.viewType != 'LIST'}">
                    <ice:commandLink actionListener="#{contests.setViewType}" value="List View">
                        <f:attribute name="viewType" value="LIST" />
                    </ice:commandLink>
                </f:subview>
                <f:subview rendered="#{contests.viewType == 'LIST'}">
                    <ice:outputText value="List View" />
                </f:subview>
            </div>
        </div>
    </div>
  
  <div class="show">
    <ice:commandLink value="Show prior contests" actionListener="#{contests.toggleActiveInactive}" rendered="#{contests.showActiveOnly}"/>
    <ice:commandLink value="Show active contests" actionListener="#{contests.toggleActiveInactive}" rendered="#{not contests.showActiveOnly}"/>
  </div>
  <div class="divider"></div> 
  <div class="show"><a href="/web/guest/feedback">Suggest a new contest</a></div> 
 <div class="filter">
    <ice:inputText value="#{contests.filterString}" onfocus="if (this.value == 'Filter contests') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Filter contests';}" />
 </div>
    </ice:form><br />
 </div> <!-- /headline -->
    <f:subview value="Show active contests" actionListener="#{contests.toggleActiveInactive}" rendered="#{not contests.showActiveOnly}">
        <h3>Archived</h3>
    </f:subview>
  
  
  <ui:include src="./contests/#{contests.viewType}_page.xhtml" />
  
    <ice:panelGroup styleClass="hidden" >
	    #{contests}
        <script type="text/javascript">
            jQuery(document).ready(function() {
                setTimeout(function() {
                   initializeColumnsInfo();
                    makeNANotesVisible();
                }, 3000);
            });

        </script>
    </ice:panelGroup>
</div>
</f:view>
