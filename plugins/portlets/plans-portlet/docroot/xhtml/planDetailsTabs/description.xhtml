<?xml version="1.0"?>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:liferay-faces="http://liferay.com/tld/faces"
        xmlns:collab="http://climatecollaboratorium.org/components">
    <div class="description normal">
        <div class="versionsContainer">
            <div class="versions">
                <ice:dataTable value="#{planBean.plan.allDescriptionVersions}" rows="10" var="historyItem">
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="Date"/>
                        </f:facet>
                        <ice:commandLink value="#{historyItem.updateDate}"
                                         actionListener="#{planBean.plan.selectDescriptionVersion}">
                            <f:attribute name="item" value="#{historyItem}"/>
                        </ice:commandLink>


                    </ice:column>
                    <ice:column>
                        <f:facet name="header">
                            <ice:outputText value="User"/>
                        </f:facet>
                        <ice:outputText value="#{historyItem.updateAuthor.screenName}"/>


                    </ice:column>
                </ice:dataTable>
                <br/>

            </div>
        </div>
        <ice:panelGrid styleClass="toolbar" columns="3">
            <ice:panelGroup styleClass="edit editControls"
                            rendered="#{permissions.canEdit and not planBean.editingDescription}">
                <ice:commandLink styleClass="editButton" value="Edit" actionListener="#{planBean.editDescription}"
                        />
            </ice:panelGroup>
            <ice:panelGroup styleClass="save editControls" rendered="#{planBean.editingDescription}">
                <ice:commandLink value="Save Changes" actionListener="#{planBean.plan.saveDescription}"/>
            </ice:panelGroup>
            <ice:panelGroup styleClass="cancelEdit editControls" rendered="#{planBean.editingDescription}">
                <ice:commandLink value="Cancel" actionListener="#{planBean.editDescription}"/>
            </ice:panelGroup>


            <ice:panelGroup styleClass="chooseVersionWidget">
                <a href="javascript:;" onclick="triggerVersionsContainerVisibility();" class="versionsTrigger">Show old versions</a>


            </ice:panelGroup>
        </ice:panelGrid>


        <div class="clear"></div>
        <collab:helpMessage messageId="planDescriptionHelp" styleClass="planHelp"
                            hideThisMessage="Hide this message">
            Teams are invited to outline:
<ul>
    <li>why their proposed actions and anticipated impacts are desirable</li>
 <li>how the designated commitments can be achieved</li>
</ul>
Teams may also include a vision of how the future will look under their proposal, through videos, pictures, or stories.
   <a href="/web/guest/resources/-/wiki/Main/About+proposals">See more</a>.         
        </collab:helpMessage>
        <collab:helpMessageTrigger messageId="planDescriptionHelp">+show help</collab:helpMessageTrigger>


        <ice:panelGroup rendered="#{not planBean.editingDescription and planBean.plan.descriptionSet}"
                        styleClass="planDescription">
            <ice:panelGroup styleClass="versionInfo" rendered="#{not planBean.plan.descriptionLatestVersion}">
                Viewing version from &amp;nbsp; <strong><ice:outputText
                    value="#{planBean.plan.descriptionVersionDate}"/></strong> by &amp;nbsp;
                <a href="/web/guest/members?userId=#{planBean.plan.descriptionVersionAuthor.userId}">
                    <strong><ice:outputText value="#{planBean.plan.descriptionVersionAuthor.screenName}"/></strong>
                </a>
            </ice:panelGroup>
            <ice:outputText value="#{planBean.plan.description}" escape="false"/>

        </ice:panelGroup>

        <ice:panelGroup rendered="#{planBean.editingDescription}"
                        styleClass="editWithVersions descriptionEditContainer">

            <div class="descriptionInput">
                <ice:inputRichText value="#{planBean.plan.description}" saveOnSubmit="true" skin="office2003"
                                   height="500px" partialSubmit="true"/>

            </div>
        </ice:panelGroup>


        <ice:panelGroup rendered="#{not planBean.plan.descriptionSet and not planBean.editingDescription}">
            <ice:panelGroup styleClass="versionInfo" rendered="#{not planBean.plan.descriptionLatestVersion}">
                Viewing version from &amp;nbsp; <strong><ice:outputText
                    value="#{planBean.plan.descriptionVersionDate}"/></strong> by &amp;nbsp;
                <a href="/web/guest/members?userId=#{planBean.plan.descriptionVersionAuthor.userId}">
                    <strong><ice:outputText value="#{planBean.plan.descriptionVersionAuthor.screenName}"/></strong>
                </a>
            </ice:panelGroup>

            <div class="nothingSetInfo">
                <div class="nothingSetMessage">No description set.</div>
            </div>
        </ice:panelGroup>

        <ice:panelGroup styleClass="hidden ">
            <script type="text/javascript">
                Collab.nav.addEditorDirtyValidationCallback(checkIfPlanDescriptionDirty);
            </script>
        </ice:panelGroup>

    </div>
</f:view>