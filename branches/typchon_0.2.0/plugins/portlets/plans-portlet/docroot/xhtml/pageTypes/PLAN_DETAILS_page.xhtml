<?xml version="1.0"?>
<f:view
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:collab="http://climatecollaboratorium.org/facelets">
        
<div class="proposal-head">
    <div class="inner">
        <div class="headline">
            <div class="proposal-image"><img src="#{proposal.plan.image}" width="52" height="52" alt="Contest Image" /></div>
            <div class="proposal-title">
                <div class="prop-description">
                    Proposal for 
                    <collab:contestLink contestId="#{contest.contest.contestId}" text=" #{contest.contest.shortName} " />
                    by
                    <f:subview rendered="#{empty proposal.plan.team}">
                        <collab:userLinkSimple userId="#{proposal.plan.author.userId}" text=" #{proposal.plan.author.screenName}" />
                    </f:subview>
                    <f:subview rendered="#{not empty proposal.plan.team}">
                        #{proposal.plan.team}
                    </f:subview>
                </div>
                <h1>#{proposal.plan.name}</h1>
            </div>
        </div> <!-- /headline -->
        <div class="prop-tabs">
            <ice:form>
                <ul>
                    <ui:repeat value="#{proposal.availableTabs}" var="tabWrapper">
                        <li class="#{proposal.currentTab == tabWrapper.tab ? 'c' : ''}">
                            <ice:commandLink value="#{tabWrapper.displayName}" onclick="Collab.nav.navigateAddParams('plans', {tab: '#{tabWrapper.tab}'}); return false;" >
                                <f:subview rendered="#{tabWrapper.hasActivityCount}">
                                    <div>#{tabWrapper.activityCount}</div>
                                </f:subview>
                            </ice:commandLink>
                        </li>
                    </ui:repeat>
                </ul>
            </ice:form>
        </div>
    </div> <!-- /inner -->
</div> <!-- /proposal-head -->



    <ice:panelGroup rendered="#{permissions.canEdit and plan.currentTab.editable and not plan.editing}">
        <div class="edit-prop-wrap">
            <div class="inner">
                <div class="edit-prop">
                    <ice:form>
                        <div class="edit-prop-butts">
                            <ice:commandLink value="Edit" actionListener="#{planBean.toggleEditing}" />
                            <a href="javascript:;" onclick="triggerVersionsContainerVisibility(this);" >Show history</a>
                        </div> 
                        <!-- <div class="lastedited">Last edited 5 days ago by <a href="javascript:;">&amp;nbsp;beachbabe-in-fl</a></div>-->
                    </ice:form>
                </div>
            </div>
        </div>
    </ice:panelGroup>
 

<div id="content">
    <ui:include src="./plan/tab_#{proposal.currentTab}#{proposal.editing and proposal.currentTab.editable ? '_edit' : '' }.xhtml" />
</div>
 
</f:view>
