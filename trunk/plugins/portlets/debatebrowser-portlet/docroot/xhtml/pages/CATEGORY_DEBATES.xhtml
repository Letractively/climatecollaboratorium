<?xml version="1.0"?>
<f:view 
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:liferay-faces="http://liferay.com/tld/faces"
    xmlns:h="http://java.sun.com/jsf/html"  
    xmlns:ice="http://www.icesoft.com/icefaces/component" 
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    >
    <ui:composition template="./pageTemplate.xhtml">
        <ui:define name="pageType">Debate category</ui:define>
        <ui:define name="pageName">#{debateBrowserBean.category.title}</ui:define>
        <ui:define name="breadcrumb">
            <img height="8" src="/collaboratorium-theme/images/arrow.gif" width="8" />
            <a href="/web/guest/debate-browser/-/debates/categoryId/#{debateBrowserBean.category.wrapped.debateCategoryPK}">#{debateBrowserBean.category.title}</a>
        </ui:define>
        <br />
        <ice:form>
            <div class="floatRight">
                <ice:commandButton styleClass="mothButton" value="Add debate" actionListener="#{debateBrowserBean.toggleAddDebateForm}" rendered="#{permissions.canAddDebate}" />
            </div>
            
            <div class="clear">
            </div>
            
        </ice:form>
        <ice:form>
        <f:subview rendered="#{debateBrowserBean.category.edit}">
            <ice:inputText value="#{debateBrowserBean.category.title}" styleClass="profile_input" required="true" /><br />
            <ice:inputTextarea value="#{debateBrowserBean.category.description}" styleClass="profile_about" style="height: 100px;"/><br />
            <ice:commandButton styleClass="mothButton" actionListener="#{debateBrowserBean.category.save}" value="Save" />
            <ice:commandButton styleClass="mothButton" actionListener="#{debateBrowserBean.category.toggleEdit}" value="Cancel" partialSubmit="true" />
        
        </f:subview>
        <f:subview test="#{not debateBrowserBean.category.edit}">
            <h2><a href="/web/guest/debate-browser/-/debates/categoryId/#{debateBrowserBean.category.wrapped.debateCategoryPK}">#{debateBrowserBean.category.title}</a></h2>
            <p>#{debateBrowserBean.category.description}</p>
            
            <f:subview rendered="#{permissions.canEditCategory}">
                <div class="floatRight">
                    <ice:commandButton styleClass="mothButton" actionListener="#{debateBrowserBean.category.toggleEdit}" value="Edit" />
                </div>
                <div class="clear">
                </div>
            </f:subview>
        </f:subview>
        </ice:form>
        
        
        <ice:form>
        <ice:dataTable var="debate" value="#{debateBrowserBean.category.debates}" styleClass="issues" columnClasses="b,issue-votes-count,issue-com" sortColumn="#{debateBrowserBean.category.sortColumn}" sortAscending="#{debateBrowserBean.category.sortAscending}">
            <ice:column>
                        <f:facet name="header">
                            <ice:commandSortHeader columnName="name" arrow="false">
                                DEBATE TITLE
                            </ice:commandSortHeader>
                        </f:facet>
                        
                <a href="/web/guest/debate-browser/-/debates/categoryId/#{debateBrowserBean.category.wrapped.debateCategoryPK}/debateId/#{debate.debateId}">
                    #{debate.currentRoot.debateSummary}   
                </a>
            </ice:column>
            <ice:column style="width: 100px;">
            
                        <f:facet name="header">
                            <ice:commandSortHeader columnName="votes" arrow="false">
                                NO. OF VOTES
                            </ice:commandSortHeader>
                        </f:facet>
                        
                #{debate.totalVotesCount}
            </ice:column>
            <ice:column style="width: 80px;">
            
            
                        <f:facet name="header">
                            <ice:commandSortHeader columnName="comments" arrow="false">
                                COMMENTS
                            </ice:commandSortHeader>
                        </f:facet>
                        
                #{debate.numberOfComments}
            </ice:column>
        </ice:dataTable>
        </ice:form>
        
    
    </ui:composition>
</f:view>
