<!--
  ~ Copyright (c) 2010. M.I.T. All Rights Reserved
  ~ Licensed under the MIT license. Please see http://www.opensource.org/licenses/mit-license.php
  ~ or the license.txt file included in this distribution for the full text of the license.
  -->

<f:view xmlns:f="http://java.sun.com/jsf/core" xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:portlet>
    
        <script type="text/javascript">
            jQuery(document).ready(function() {
                Collab.nav.unblock();
            });
        </script>
                    <ice:outputConnectionStatus/>
        <ice:messages globalOnly="false" layout="table" />
		<ice:form>
			<ice:outputStyle href="/xmlhttp/css/xp/xp-portlet.css" />
			<ice:panelTabSet styleClass="componentPanelTabSetLayout">
				<ice:panelTab label="Questions for assumptions">
                    <strong><ice:outputLabel for="questions" value="Select how many proposals should be displayed for each contest:" /></strong>
                    <ice:dataTable value="#{preferences.contestPreferences}" var="contestPref">
                        <ice:column>
                            #{contestPref.contest.contestName}
                        </ice:column>
                        <ice:column>
                            <ice:inputText value="#{contestPref.maxProposalsCount}" />
                        </ice:column>                           
                    </ice:dataTable>
                    <ice:commandButton value="Submit" action="#{preferences.submit}" />
				</ice:panelTab>
                <ice:panelTab label="Migration">
                    <ice:messages globalOnly="false" layout="table" />
                    <ice:commandButton action="#{migrationTool.migrate}" value="MIGRATE" onclick="if(!confirm('Are you sure you want to proceed with migration?')){ return false; }"/>
                </ice:panelTab>
                <ice:panelTab label="Migrate discussions">
                    <ice:messages globalOnly="false" layout="table" />
                    <ice:commandButton action="#{migrationTool.migrateDiscussions}" value="MIGRATE DISCUSSIONS" onclick="if(!confirm('Are you sure you want to proceed with discussions migration?')){ return false; }"/>
                    
                    <ice:commandButton action="#{migrationTool.updateDiscussionUrlsAndDescriptions}" value="UPDATE DISCUSSIONS Descriptions/Urls" />
                    <ice:commandButton action="#{migrationTool.updateDiscussionsPermissions}" value="Update discussions permissions" />
                    
                </ice:panelTab>
                <ice:panelTab label="Proposal settings">
                    <ice:messages globalOnly="false" layout="table" />
                    <ice:inputTextarea value="#{preferences.defaultDescription}" style="width: 90%; height: 400px" /><br />
                    <ice:commandButton value="Update" />
                
                </ice:panelTab>
                <ice:panelTab label="Update plan open attribute">
                    <ice:messages globalOnly="false" layout="table" />
                    <ice:commandButton value="Update plan open attribute and supporters" action="#{migrationTool.updatePlanOpenAttribute}" />
                
                </ice:panelTab>
			</ice:panelTabSet>
		</ice:form>
	</ice:portlet>
</f:view>